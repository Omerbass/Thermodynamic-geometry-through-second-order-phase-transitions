\documentclass[%
 reprint,
%superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,
%pra,
%prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}

% For Thesis
% \documentclass[pra,preprint, ,superscriptaddress,notitlepage,longbibliography]{revtex4-2}
% \usepackage{anyfontsize}
% \renewcommand{\normalsize}{\fontsize{12}{14}\selectfont}
% \linespread{1.5}
% \usepackage[margin=1.5cm]{geometry}
% \usepackage{newtxtext,newtxmath}

\usepackage[normalem]{ulem}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{cancel}
\usepackage{nicefrac}
\usepackage{multirow}
\usepackage[dvipsnames]{xcolor} % for colors 
\usepackage{xspace}
\usepackage[hidelinks]{hyperref}
\usepackage{caption}
\usepackage{subcaption}

%\newcommand{\oren}[1]{{\color{red} [Oren:]\xspace}}%\usepackage{hyperref}% add hypertext capabilities
\newcommand{\oren}[1]{{\color{red} [Oren: #1]\xspace}}
\newcommand{\omer}[1]{{\color{ForestGreen} [Omer: #1]\xspace}}
\newcommand{\arctanh}[0]{\text{arctanh}}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\done}[0]{{\color{ForestGreen} \checkmark \quad}}

%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}

\begin{document}

\preprint{APS/123-QED}

\title{Thermodynamic Geometry Through Second Order Phase Transitions}

\author{Omer Michael Basri}
 \email{omer.basri@weizmann.ac.il}
\author{Oren Raz}
 \email{oren.raz@weizmann.ac.il}
\affiliation{%
 Department of Physics of Complex Systems,\\Weizmann Institute of Science, Rehovot 76100, Israel. 
}%

\date{\today}

\begin{abstract}

\end{abstract}

\maketitle

\section{Introduction}

Since the earliest developments of thermodynamics, there have been attempts to cast the theory in geometric form \cite{gibbs1873method}. A geometric interpretation exists for equilibrium thermodynamics—for instance, the work performed by a heat engine corresponds to the area enclosed by its stroke in the $PV$ plane. However, an analogous geometric relation for excess dissipation in non-equilibrium processes remains elusive.

One approach that bridges this gap is thermodynamic geometry, introduced in the 1970s by Ruppeiner and Weinhold \cite{ruppeinerThermodynamicsRiemannianGeometric1979, weinholdMetricGeometryEquilibrium1975}. In their formulation, the space of thermodynamic parameters is endowed with a Riemannian metric derived from the second derivatives of a thermodynamic potential—such as the internal energy, entropy, or any of their Legendre transforms. Although the choice of potential changes the explicit form of the metric, the resulting manifold remains invariant \cite{salamonRelationEntropyEnergy1984}.

In the 1980s, Salamon \cite{salamonThermodynamicLengthDissipated1983} established a connection between excess dissipation and thermodynamic length in this metric space, subject to two important limitations. First, the result holds only for endoreversible processes, where the system remains in internal equilibrium but may be out of equilibrium with its environment. Second, the dissipation depends explicitly on the mean response time of the system, restricting the formalism’s applicability to systems with uniform relaxation times. Despite these limitations, the framework has proven valuable for identifying minimal-entropy-production protocols in processes such as chemical reactions and distillation \cite{andresenCurrentTrendsFiniteTime2011}.

Building on this line of work, Sivak and Crooks \cite{sivakThermodynamicMetricsOptimal2012, crooksMeasuringThermodynamicLength2007} derived a closely related metric using linear response theory. In their formulation, the system’s relaxation dynamics are incorporated directly into the metric, thereby removing the dependence on a separate response-time parameter and eliminating the assumption of endoreversibility. This generalized framework extends thermodynamic geometry to a much broader class of systems—including those with widely varying time scales and microscopic systems such as biomolecular or single-molecule systems—and has found applications in optimizing computational and physical processes \cite{rotskoffGeometricApproachOptimal2017}.

A particularly challenging class of systems exhibiting widely separated time scales are those undergoing phase transitions. The application of thermodynamic geometry to such systems has drawn significant attention \cite{janyszekRiemannianGeometryThermodynamics1989, PhysRevE.51.1006}, including efforts to identify optimal driving protocols across critical regions (e.g., the 2D ferromagnetic Ising model \cite{rotskoffDynamicRiemannianGeometry2015}). Yet, the divergence of thermodynamic length near phase transitions has received limited study. Notably, a divergence in the metric tensor does not necessarily imply a divergence in thermodynamic length—much as the divergence of the Schwarzschild metric at $r=r_s$ does not correspond to a physical singularity.

In systems with disconnected phases, any transformation from one phase to another must necessarily cross a phase transition. One such case, examined in this work, is the mean-field antiferromagnet, where the phase boundary entirely separates distinct thermodynamic states. Determining whether the thermodynamic length remains finite near such transitions is crucial for understanding the applicability of thermodynamic geometry in these regimes.

Both the Ruppeiner and Sivak metrics predict that the thermodynamic metric should diverge in the vicinity of a second-order phase transition (see Sec.~\ref{sec:framework}). A natural question, therefore, is whether this divergence of the metric translates into a divergence of the corresponding thermodynamic lengths. Note that even if the length remains finite, other geometric quantities such as the curvature may diverge, signaling critical behavior. Though these do not directly contribute to dissipation and are thus outside our present focus.

In this paper, we analyze the behavior of thermodynamic geometry near second-order phase transitions. We show that the Ruppeiner and Sivak manifolds exhibit qualitatively distinct behavior around criticality, primarily due to the phenomenon of critical slowing down. Interestingly, in both formalisms, there exist cases where the metric does not diverge at the transition.

Finally, we apply the Sivak metric to determine the optimal protocol connecting two points in different phases of the mean-field antiferromagnet. Because the two phases are entirely separated by a phase boundary, any such protocol necessarily traverses a phase transition. Our results show that, while the thermodynamic length can diverge for the Sivak metric in certain models, it remains finite for all cases examined under the Ruppeiner metric.


\section{Framework} \label{sec:framework}
Before analyzing thermodynamic geometry near second-order phase transitions, we briefly define the key metrics and scaling tools used in our study.

\subsection{Ruppeiner and Weinhold Metric}
The Ruppeiner–Weinhold metric \cite{ruppeinerThermodynamicsRiemannianGeometric1979, weinholdMetricGeometryEquilibrium1975} is defined as the Hessian of a thermodynamic potential or generalized entropy:
\begin{equation}
    g_{\mu\nu}^R = \pm \frac{\partial^2 \varphi}{\partial \lambda^\mu \partial \lambda^\nu},
\end{equation}
where $\varphi$ is a thermodynamic potential (e.g., internal energy, entropy, or a Legendre transform), and $\lambda^\mu$ are its natural variables (e.g., $\{S, M\}$ for $E(S, M)$).
The sign ensures positive definiteness, consistent with the convexity or concavity of $\varphi$ \cite{Callen:450289}.

Salamon \cite{salamonThermodynamicLengthDissipated1983} connected this metric to excess dissipation through the \emph{dissipated availability},
\begin{equation}
    \mathcal{A} = \bar{\epsilon} \int_{\boldsymbol{\lambda}(s)} g^R_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu\, ds,
\end{equation}
where $\bar{\epsilon}$ is the average response time. The corresponding \emph{thermodynamic length} is
\begin{equation}
    \mathcal{L} = \int_{\boldsymbol{\lambda}(s)} \sqrt{g_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu}\, ds.
\end{equation}
Minimizing $\mathcal{L}$ minimizes excess dissipation for a fixed-duration protocol, since the Cauchy–Schwarz inequality gives
\begin{equation}
    \mathcal{A} \ge \frac{\bar{\epsilon}}{\tau}\mathcal{L}^2,
\end{equation}
with equality for constant-speed protocols (i.e $\left\|\dot{\boldsymbol{\lambda}}\right\|=\text{const.}$).

\subsection{Sivak and Crooks Metric}
The Ruppeiner metric assumes endoreversibility and uniform response times, which limit its scope. Sivak and Crooks \cite{sivakThermodynamicMetricsOptimal2012} removed these restrictions using linear-response theory, defining
\begin{equation}
    g_{\mu\nu}^S = \int_0^\infty \langle \delta X_\mu(t)\, \delta X_\nu(0) \rangle\, dt =
    \mathcal{T}_{\mu\nu} \frac{\partial^2 \ln Z}{\partial \lambda^\mu \partial \lambda^\nu},
\end{equation}
where $\mathcal{T}_{\mu\nu}$ is the time-response matrix, $Z$ the partition function, and $X_\mu$ the conjugate variable to $\lambda^\mu$.
The response time is thus encoded directly in the metric, and the dissipated availability becomes
\begin{equation}
    \mathcal{A} = \int_{\boldsymbol{\lambda}(t)} g^S_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu\, dt,
\end{equation}
with the inequality
\begin{equation}
    \mathcal{A} \ge \frac{\mathcal{L}^2}{\tau},
\end{equation}
again saturated by constant-speed protocols.

\subsection{Scaling Hypothesis} \label{subsec:ScalingHypothesisFramework}
Near second order phase transitions, derivatives of the free energy -- and hence the Ruppeiner and Sivak metrics often diverge (for example, via diverging magnetic susceptibility). 
Although exact partition functions are rarely tractable, the asymptotic form of these divergences is determined by critical exponents defining universality classes.

The scaling hypothesis relates the free energy near the critical point $(T_c, H_c)$ to reduced variables $t = (T - T_c)/T_c$ and $h = (H - H_c)/H_c$:
\begin{equation}
    \varphi \propto t^b f\!\left(\frac{h}{t^\Delta}\right),
\end{equation}
where $f(x)$ is continuous and $f(x) \sim x^p$ as $x \to \infty$ \cite{Kardar_2007}.
The exponents $b$, $\Delta$, and $p$ can be determined by standard critical exponents, e.g., $b = 2 - \alpha$ from the heat capacity exponent $\alpha$.
This approach captures metric divergences across universality classes but does not address relaxation times, which are critical the dissipation in the Ruppiner formalism, and for the definition of the Sivak metric.

\subsubsection*{Dynamic Scaling Hypothesis}
Critical slowing down near second-order transitions leads to divergent relaxation times. The dynamic scaling hypothesis relates the relaxation time $\tau$ and correlation length $\xi$ as
\begin{equation}
    \tau \propto \xi^z
\end{equation}
and the free energy scales as $\varphi \propto \xi^{-d}$ \cite{Kardar_2007, tauberCriticalDynamicsField2014}.
Combining these yields
\begin{equation}
    \tau \propto \varphi^{-z/d} \propto t^{-bz/d}\, f^{-z/d}\!\left(\frac{h}{t^\Delta}\right),
\end{equation}
linking dynamical and thermodynamic critical behavior.

\subsection{Divergence of Lengths}
A diverging metric does not necessarily imply a divergent thermodynamic length -- analogous to how the Schwarzschild metric diverges at $r = r_s$ without a corresponding geometric singularity. 
For constant-speed protocols of fixed duration,
\begin{equation}
    \mathcal{A} \propto \mathcal{L}^2.
\end{equation}
Thus, a finite thermodynamic length guarantees the existence of a finite-dissipation protocol. As opposed to that, from the Cauchy-Schwarz inequality $\mathcal{L} \to \infty$ implies $\mathcal{A} \to \infty$.

Consequently, the convergence of thermodynamic length determines whether finite-dissipation protocols exist. 
If $\ell(s) = \sqrt{g_{\mu\nu}\dot{\lambda}^\mu\!\left(s\right)\dot{\lambda}^\nu\!\left(s\right)} \propto s^{-p}$ near criticality (as $s \rightarrow 0$), the total length diverges only for $p > 1$. 

Note that this observation does not necessarily inform  us about the metric itself, or intrinsic geometry of the manifold. The metric might diverge for flat space \cite{PhysRev.119.1743,Szekeres:1960gm}, and the manifold might have divergent curvature despite having finite lengths and a non-divergent metric. 


\section{Results}
\subsection{Scaling Hypothesis \label{subsec:ScalingHypothesisResults}}
\subsubsection{Scaling Hypothesis for the Free Energy}
We use the scaling hypothesis for the free energy to deduce the divergence of the Ruppiner metric, and understand wether the length diverges on paths that pass through a phase transition.


Assuming the divergent part of the Massieu potential scales as
\[ \psi \propto t^b f\left(\frac{h}{t^\Delta}\right) \]
With all the assumptions made so far, the scaling of the metric as $t,h\rightarrow 0 $ is given by:
\begin{align}
    \left(g_{\mu\nu}\right) \Big|_{\frac{h}{t^\Delta} \rightarrow \text{const.}} & \propto \left(\begin{array}{cc}
        t^{b-2} & t^{b-\Delta-1} \\
        t^{b-\Delta-1} & t^{b-2 \Delta}
    \end{array} \right) \\
    \left( g_{\mu\nu} \right) \Big|_{\frac{h}{t^\Delta} \rightarrow \infty} & \propto \left(\begin{array}{cc}
        t^{-2} h^{p} & t^{-1} h^{p-1} \\
        t^{-1} h^{p-1} & h^{p-2}
    \end{array} \right)
\end{align}
Note how we take the limits: We take both $t$ and $h$ to $0$, in such a way that either $\frac{h}{t^\Delta}$ tends to a constant value, or to infinity. This gives different limits for $f$, and therefore also different limits for the thermodynamic potentials and the metric, as seen in \ref{subsec:ScalingHypothesisFramework}.

To determine from this how lengths diverge, we need information about the path taken, as it determines the asymptotic {behaviour} of $ \frac{h}{t^\Delta} $. We therefore split our analysis to corresponding cases. The first is
\begin{equation} \label{case_1}
    \left( \begin{array}{c}
         t \\
         h 
    \end{array} \right) = \left( \begin{array}{c}
         s \\
         s^k 
    \end{array} \right) , \quad k \ge \Delta
\end{equation}
Which implies
\begin{equation*}
    \frac{h}{t^\Delta} \xrightarrow[s\rightarrow0]{} \text{const.}
\end{equation*}
In this case, the integrands are
\begin{equation*}
    g_{tt} \frac{dt}{ds} \frac{dt}{ds} \propto s^{b-2}
\end{equation*}
\begin{equation*}
    g_{th} \frac{dt}{ds} \frac{dh}{ds} \propto s^{b-\Delta-1} s^{k-1}=s^{b-2+\left(k-\Delta\right)}
\end{equation*}
\begin{equation*}
    g_{hh} \frac{dh}{ds} \frac{dh}{ds} \propto s^{b-2\Delta} s^{2\left(k-1\right)} =s^{b-2+2\left(k-\Delta\right)}
\end{equation*}
Since $k\ge\Delta$ we get that 
\begin{equation} \label{h_t_delta_non_divergent}
    b > 0
\end{equation} 
is a sufficient condition for the Ruppiener length, $\mathcal{L}$, to converge. Which, as we have established, is a necessary and sufficient condition for convergence of the Salomon dissipated availability, $\mathcal{A}$, for finite time protocols, unless $\bar{\epsilon}$ diverges. 

The second option is
\begin{equation} \label{case_2}
    \left( \begin{array}{c}
         t \\
         h 
    \end{array} \right) = \left( \begin{array}{c}
         s^{\nicefrac{1}{k}} \\
         s 
    \end{array} \right) , \quad k < \Delta
\end{equation}
which implies
\begin{equation*} 
    \frac{h}{t^\Delta} \xrightarrow[s\rightarrow 0]{} \infty
\end{equation*}
In this case
\begin{equation*}
    g_{tt} \frac{dt}{ds} \frac{dt}{ds} \propto s^{-\nicefrac{2}{k}}s^p s^{2\left(\frac{2}{k}-1\right)} = s^{p-2}
\end{equation*}
\begin{equation*}
    g_{th} \frac{dt}{ds} \frac{dh}{ds} \propto s^{-\nicefrac{1}{k}} s^{p-1} s^{\frac{1}{k}-1} = s^{p-2}
\end{equation*}
\begin{equation*}
    g_{hh} \frac{dh}{ds} \frac{dh}{ds} \propto s^{p-2}
\end{equation*}


So there exist finite time protocols that do not diverge for a system when
\begin{equation} \label{h_t_delta_divergent}
    p>0
\end{equation}
% \oren{Same as the discussion above -- why not $p>1$?}
One can observe in table \ref{tab:scaling-divergences} that both conditions \ref{h_t_delta_non_divergent} and \ref{h_t_delta_divergent} hold in multiple universality classes.  %\oren{Maybe it is better to put the specific mean field example here, as it actually belong to the above discussion, not to what follow.} \omer{The mean field discussion was supposed to be for the numerical part, should it appear also in the context of scaling of the free energy/its derivatives?}

 \begin{table}
    \centering
    \begin{tabular}{c||c|c}
         & $b$ & $p$ \\
         \hline \hline 
         Mean Field & $ 2 $ & $ \frac{4}{3} $ \\
         \hline 
         2D Ising & $ 2 $ & $ \frac{16}{15} $ \\
         \hline 
         3D Ising & $ 1.88991292(35) $ & $ 1.2087751(6) $ \\
         \hline 
         2D 3-state Potts model & $ \frac{5}{3} $ & $ \frac{15}{14} $ \\
         \hline 
         2D 4-state Potts model & $ \frac{4}{3} $ & $ \frac{16}{15} $
         % \\
         % \hline 
         % 3D XY Model & $ 2.0153(3) $ & $ 1.20923(6) $
    \end{tabular}
    \caption{Scaling Hypothesis parameters for sample universality classes}
    \label{tab:scaling-divergences}
\end{table}

\subsubsection{Dynamical Scaling Hypothesis}

As we have seen, all attempts to use metrics to study dissipation take into account the system's response time. In the Ruppiner formalism this appears in the mean response time element $\bar{\epsilon}$, and in the Sivak formalism it appears directly in the metric. Here we use the dynamical scaling hypothesis to study the scaling of the response time, $\tau$.

We have seen that $\tau$ scales as:
$ \tau \propto \psi ^ {-\nicefrac{z}{d} } $, so using the static scaling hypothesis
\begin{equation}
    \tau \propto t^{-\nicefrac{bz}{d}} g\left(\frac{h}{t^\Delta}\right)
\end{equation}
with $g$ continuous and 
\begin{equation}
    g \xrightarrow[x\rightarrow \infty]{} x^{-\nicefrac{pz}{d}},
\end{equation}
the divergence of $\tau$ is
\begin{equation}
    \tau \propto 
    \begin{cases}
        t^{-\nicefrac{bz}{d}}  &  \frac{h}{t^\Delta} \rightarrow \text{const.} \\
        h^{-\nicefrac{pz}{d}}  &  \frac{h}{t^\Delta} \rightarrow \infty
    \end{cases}
\end{equation}

Adding this factor to the case of the divergences in eq. \ref{case_1}
\begin{align}
    g_{tt} \left(\frac{dt}{ds}\right)^2 & \propto s^{b\left(1-\frac{z}{d}\right) -2 } \\
    g_{th} \frac{dt}{ds} \frac{dh}{ds} & \propto s^{b\left(1-\frac{z}{d}\right) -2 + \left(k-\Delta\right) } \\
    g_{hh} \left(\frac{dh}{ds}\right)^2 & \propto s^{b\left(1-\frac{z}{d}\right) -2 + 2\left(k-\Delta\right)} 
\end{align}
Meaning the convergence condition for the thermodynamic length will be 
\begin{equation}
    b\left(1-\frac{z}{d}\right) > 0
\end{equation}

Similarly in case \ref{case_2}:
\begin{equation}
    g_{ij}  \frac{dx^i}{ds} \frac{dx^j}{ds} \propto s^{p\left(1-\frac{z}{d}\right) -2}
\end{equation}
Meaning the convergence condition for the thermodynamic length will be 
\begin{equation}
    p\left(1-\frac{z}{d}\right) > 0
\end{equation}
One can see, using table \ref{tab:dynamical-divergences}, that the lengths will diverge for the 2D Ising model and Potts models (both 3- and 4-states), but in the 3D Ising model, lengths converge.
 \begin{table}
    \centering
    \begin{tabular}{c|c||c|c|c}
         
         \multicolumn{2}{c||}{} & $d$ & $z$ & $\frac{z}{d}$\\
         \hline \hline 
         \multirow{2}{*}{2D Ising}  & Class A & $ 2 $ & $ 2.165\left(10\right) $ & $1.083\left(5\right)$ \\
         \cline{2-5}
                                    & Class B & $ 2 $ & $ 2.235\left(10\right) $ & $1.117\left(5\right)$ \\ 
                                    % I'm not sure model B dynamics are interesting in our case.
         \hline 
         \multicolumn{2}{c||}{3D Ising} & $ 3 $ & $ 2.032\left(4\right) $ & $ 0.677\left(1\right) $ \\
         \hline
         \multicolumn{2}{c||}{2D 3-state Potts model} & $2$ & $2.198(2)$ & $1.099(1)$ \\
         \hline
         \multicolumn{2}{c||}{2D 4-state Potts model} & $2$ & $2.290(3)$ & $1.095(2)$ \\
    \end{tabular}
    \caption{Dynamical Scaling parameters for sample universality classes \cite{odor_universality_2004}}
    \label{tab:dynamical-divergences}
\end{table}

\subsection{Antiferromagnetic Mean-Field Model - Ruppiner metric}
\input{AntiFerro-MeanField-Ruppiner/Intro}
\input{AntiFerro-MeanField-Ruppiner/disorderedPhase}
\input{AntiFerro-MeanField-Ruppiner/AntiFerroPhase}
 \subsection{Antiferromagnetic Mean-Field Model - Sivak metric}
 \omer{I wrote this assuming we will only publish this, and not the Ruppiner metric}
 
\input{AntiFerro-MeanField-Sivak/intro}
\input{AntiFerro-MeanField-Sivak/disorderedPhase}
\input{AntiFerro-MeanField-Sivak/AntiFerroPhase}
\input{AntiFerro-MeanField-Sivak/minimalPaths}

\input{2D_Ising_Calculation}


\bibliography{ThermodynamicGeometry}
\end{document}