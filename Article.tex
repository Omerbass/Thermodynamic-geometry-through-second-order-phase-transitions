% \documentclass[%
%  reprint,
% %superscriptaddress,
% %groupedaddress,
% %unsortedaddress,
% %runinaddress,
% %frontmatterverbose, 
% %preprint,
% %preprintnumbers,
% %nofootinbib,
% %nobibnotes,
% %bibnotes,
%  amsmath,amssymb,
%  aps,
% %pra,
% %prb,
% %rmp,
% %prstab,
% %prstper,
% %floatfix,
% ]{revtex4-2}

% For Thesis
\documentclass[pra,preprint, ,superscriptaddress,notitlepage,longbibliography]{revtex4-2}
\usepackage{anyfontsize}
\renewcommand{\normalsize}{\fontsize{12}{14}\selectfont}
\linespread{1.5}
\usepackage[margin=1.5cm]{geometry}
\usepackage{newtxtext,newtxmath}

\usepackage[normalem]{ulem}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{cancel}
\usepackage{nicefrac}
\usepackage{multirow}
\usepackage[dvipsnames]{xcolor} % for colors 
\usepackage{xspace}
\usepackage[hidelinks]{hyperref}
\usepackage{caption}
\usepackage{subcaption}

%\newcommand{\oren}[1]{{\color{red} [Oren:]\xspace}}%\usepackage{hyperref}% add hypertext capabilities
\newcommand{\oren}[1]{{\color{red} [Oren: #1]\xspace}}
\newcommand{\omer}[1]{{\color{ForestGreen} [Omer: #1]\xspace}}
\newcommand{\arctanh}[0]{\text{arctanh}}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\done}[0]{{\color{ForestGreen} \checkmark \quad}}

%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}

\begin{document}

\preprint{APS/123-QED}

\title{Thermodynamic Geometry Through Second Order Phase Transitions}

\author{Omer Michael Basri}
 \email{omer.basri@weizmann.ac.il}
\author{Oren Raz}
 \email{oren.raz@weizmann.ac.il}
\affiliation{%
 Department of Physics of Complex Systems,\\Weizmann Institute of Science, Rehovot 76100, Israel. 
}%

\date{\today}

\begin{abstract}

Thermodynamic geometry provides a powerful framework to analyze the dissipation of physical systems driven out of equilibrium, but near equilibrium.
In its original formulation, the system's relaxation timescales had to be, to good approximation, constant throughout the control parameter space.
In its current form, the formalism requires that linear response theory holds.
We study the thermodynamic geometry of systems that undergo second-order phase transitions. 
Using the scaling hypothesis, we show that while the Ruppeiner metric diverges at the critical point, the thermodynamic length may remain finite.
However, for the Sivak-Crooks formulation of the metric, we show by use of the dynamical scaling hypothesis that the thermodynamic length can diverge in some systems.
We argue, that the length likely converges for higher dimensional systems.
Finally, we compute the Sivak-Crooks metric of the mean-field antiferromagnetic Ising model, and use it to study optimal protocols connecting points of interest in the system.
We show analytically that in the disordered phase, the metric effectively reduces to a 1D manifold, allowing for simple determination of optimal protocols.
In the ordered phase, we numerically find optimal protocols using the Fast-Marching method.

\end{abstract}

\maketitle

\section{Introduction}

Since the earliest developments of thermodynamics, there have been attempts to cast the theory in geometric form \cite{gibbs1873method}. A geometric interpretation exists for equilibrium thermodynamics—for instance, the work performed by a heat engine corresponds to the area enclosed by its stroke in the $PV$ plane. However, an analogous geometric relation for excess dissipation in non-equilibrium processes remains elusive.

One approach that bridges this gap is thermodynamic geometry, introduced in the 1970s by Ruppeiner and Weinhold \cite{ruppeinerThermodynamicsRiemannianGeometric1979, weinholdMetricGeometryEquilibrium1975}. In their formulation, the space of thermodynamic parameters is endowed with a Riemannian metric derived from the second derivatives of a thermodynamic potential—such as the internal energy, entropy, or any of their Legendre transforms. Although the choice of potential changes the explicit form of the metric, the resulting manifold remains invariant \cite{salamonRelationEntropyEnergy1984}.

In the 1980s, Salamon \cite{salamonThermodynamicLengthDissipated1983} established a connection between excess dissipation and thermodynamic length in this Riemannian manifold, subject to two important limitations. First, the result holds only for endoreversible processes, where the system remains in internal equilibrium but may be out of equilibrium with its environment. Second, the dissipation depends explicitly on the mean response time of the system, restricting the formalism’s applicability to systems with varying relaxation times. Despite these limitations, the framework has proven valuable for identifying minimal-entropy-production protocols in processes such as chemical reactions and distillation \cite{andresenCurrentTrendsFiniteTime2011}.

Building on this line of work, Sivak and Crooks \cite{sivakThermodynamicMetricsOptimal2012, crooksMeasuringThermodynamicLength2007} derived a closely related metric using linear response theory. In their formulation, the system’s relaxation dynamics are incorporated directly into the metric, thereby removing the dependence on a separate response-time parameter and eliminating the assumption of endoreversibility. This generalized framework extends thermodynamic geometry to a much broader class of systems—including those with widely varying time scales and microscopic systems such as biomolecular or single-molecule systems—and has found applications in optimizing computational and physical processes \cite{rotskoffGeometricApproachOptimal2017}.

A particularly challenging class of systems exhibiting widely separated time scales are those undergoing phase transitions. The application of thermodynamic geometry to such systems has drawn significant attention \cite{janyszekRiemannianGeometryThermodynamics1989, PhysRevE.51.1006}, including efforts to identify optimal driving protocols across critical regions (e.g., the 2D ferromagnetic Ising model \cite{rotskoffDynamicRiemannianGeometry2015}). Yet, the divergence of thermodynamic length near phase transitions has received limited study. Notably, a divergence in the metric tensor does not necessarily imply a divergence in thermodynamic length—much as the divergence of the Schwarzschild metric at $r=r_s$ does not correspond to a physical singularity.

In systems with disconnected phases, any transformation from one phase to another must necessarily cross a phase transition. One such case, examined in this work, is the mean-field antiferromagnet, where the phase boundary entirely separates distinct thermodynamic states. Determining whether the thermodynamic length remains finite near such transitions is crucial for understanding the applicability of thermodynamic geometry in these regimes.

Both the Ruppeiner and Sivak metrics predict that the thermodynamic metric should diverge in the vicinity of a second-order phase transition (see Sec.~\ref{sec:framework}). A natural question, therefore, is whether this divergence of the metric translates into a divergence of the corresponding thermodynamic lengths. Note that even if the length remains finite, other geometric quantities such as the curvature may diverge, signaling critical behavior. Though these do not directly contribute to dissipation and are thus outside our present focus.

In this paper, we analyze the behavior of thermodynamic geometry near second-order phase transitions. We show that the Ruppeiner and Sivak manifolds exhibit qualitatively distinct behavior around criticality, primarily due to the phenomenon of critical slowing down. Interestingly, in both formalisms, there exist cases where the metric does not diverge at the transition.

Finally, we apply the Sivak metric to determine the optimal protocol connecting two points in different phases of the mean-field antiferromagnet. Because the two phases are entirely separated by a phase boundary, any such protocol necessarily traverses a phase transition. Our results show that, while the thermodynamic length can diverge for the Sivak metric in certain models, it remains finite for all cases examined under the Ruppeiner metric.


\section{Framework} \label{sec:framework}
Before analyzing thermodynamic geometry near second-order phase transitions, we briefly define the key metrics and scaling tools used in our study.

\subsection{Ruppeiner and Weinhold Metric}
The Ruppeiner–Weinhold metric \cite{ruppeinerThermodynamicsRiemannianGeometric1979, weinholdMetricGeometryEquilibrium1975} is defined as the Hessian of a thermodynamic potential or generalized entropy:
\begin{equation}
    g_{\mu\nu}^R = \pm \frac{\partial^2 \varphi}{\partial \lambda^\mu \partial \lambda^\nu}
\end{equation}
where $\varphi$ is a thermodynamic potential (e.g., internal energy, entropy, or a Legendre transform), and $\lambda^\mu$ are its natural variables (e.g., $\{S, M\}$ for $E$).
The sign ensures positive definiteness, consistent with the convexity or concavity of $\varphi$ \cite{Callen:450289}.

Salamon \cite{salamonThermodynamicLengthDissipated1983} connected this metric to excess dissipation through the dissipated availability:
\begin{equation} \label{SalomonDissipatedAvail}
    \mathcal{A} = \bar{\epsilon} \int_{\boldsymbol{\lambda}(s)} g^R_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu\, ds
\end{equation}
where $\bar{\epsilon}$ is the average response time. The corresponding thermodynamic length is
\begin{equation}
    \mathcal{L} = \int_{\boldsymbol{\lambda}(s)} \sqrt{g_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu}\, ds
\end{equation}
Minimizing $\mathcal{L}$ minimizes excess dissipation for a fixed-duration protocol, a result of the Cauchy–Schwarz inequality:
\begin{equation}
    \mathcal{A} \ge \frac{\bar{\epsilon}}{\tau}\mathcal{L}^2
\end{equation}
with equality for constant-speed protocols (i.e $\sqrt{g_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu}=\text{const.}$).

\subsection{Sivak and Crooks Metric}
The Ruppeiner metric assumes endoreversibility and uniform response times, which limit its scope. Sivak and Crooks \cite{sivakThermodynamicMetricsOptimal2012} removed these restrictions using linear-response theory, defining
\begin{equation}
    g_{\mu\nu}^S = \int_0^\infty \langle \delta X_\mu(t)\, \delta X_\nu(0) \rangle\, dt =
    \mathcal{T}_{\mu\nu} \frac{\partial^2 \ln Z}{\partial \lambda^\mu \partial \lambda^\nu}
\end{equation}
where $\mathcal{T}_{\mu\nu}$ is the time-response matrix, $Z$ the partition function, and $X_\mu$ the conjugate variable to $\lambda^\mu$.
The response time is thus encoded directly in the metric, and the dissipated availability becomes
\begin{equation}
    \mathcal{A} = \int_{\boldsymbol{\lambda}(t)} g^S_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu\, dt
\end{equation}
with the inequality
\begin{equation}
    \mathcal{A} \ge \frac{\mathcal{L}^2}{\tau}
\end{equation}
again saturated by constant-speed protocols.

\subsection{Scaling Hypothesis} \label{subsec:ScalingHypothesisFramework}
Near second order phase transitions, derivatives of the free energy -- and hence the Ruppeiner and Sivak metrics often diverge (for example, via diverging magnetic susceptibility). 
Although exact partition functions are rarely tractable, the asymptotic form of these divergences is determined by critical exponents defining universality classes.

The scaling hypothesis relates the free energy near the critical point $(T_c, H_c)$ to reduced variables $t = (T - T_c)/T_c$ and $h = (H - H_c)/H_c$:
\begin{equation}
    \varphi \propto t^b f\!\left(\frac{h}{t^\Delta}\right),
\end{equation}
where $f(x)$ is continuous and $f(x) \sim x^p$ as $x \to \infty$ \cite{Kardar_2007}.
The exponents $b$, $\Delta$, and $p$ can be determined by standard critical exponents, e.g., $b = 2 - \alpha$ from the heat capacity exponent $\alpha$.
This approach captures metric divergences across universality classes but does not address relaxation times, which are critical the dissipation in the Ruppiner formalism, and for the definition of the Sivak metric.

\subsubsection*{Dynamic Scaling Hypothesis}
Critical slowing down near second-order transitions leads to divergent relaxation times. The dynamic scaling hypothesis relates the relaxation time $\tau$ and correlation length $\xi$ as
\begin{equation}
    \tau \propto \xi^z
\end{equation}
and the free energy scales as $\varphi \propto \xi^{-d}$ \cite{Kardar_2007, tauberCriticalDynamicsField2014}.
Combining these yields
\begin{equation}
    \tau \propto \varphi^{-z/d} \propto t^{-bz/d}\, f^{-z/d}\!\left(\frac{h}{t^\Delta}\right)
\end{equation}
linking dynamical and thermodynamic critical behavior.

\subsection{Divergence of Lengths}
A diverging metric does not necessarily imply a divergent thermodynamic length -- analogous to how the Schwarzschild metric diverges at $r = r_s$ without a corresponding geometric singularity. 
For constant-speed protocols of fixed duration,
\begin{equation}
    \mathcal{A} \propto \mathcal{L}^2
\end{equation}
Thus, a finite thermodynamic length guarantees the existence of a finite-dissipation protocol. As opposed to that, from the Cauchy-Schwarz inequality $\mathcal{L} \to \infty$ implies $\mathcal{A} \to \infty$.

Consequently, the convergence of thermodynamic length determines whether finite-dissipation protocols exist. 
If $\ell(s) = \sqrt{g_{\mu\nu}\dot{\lambda}^\mu\!\left(s\right)\dot{\lambda}^\nu\!\left(s\right)} \propto s^{-p}$ near criticality (as $s \rightarrow 0$), the total length diverges only for $p > 1$. 

Note that this observation does not necessarily inform  us about the metric itself, or intrinsic geometry of the manifold. The metric might diverge for flat space \cite{PhysRev.119.1743,Szekeres:1960gm}, and the manifold might have divergent curvature despite having finite lengths and a non-divergent metric. 


\section{Results}

\subsection{Scaling Hypothesis} \label{subsec:ScalingHypothesisResults}

\subsubsection{Scaling Hypothesis for the Free Energy}
We employ the scaling hypothesis for the free energy to analyze the divergence of the Ruppeiner 
metric and determine whether the thermodynamic length diverges along paths crossing a phase transition.

Assuming the singular part of the thermodynamic potential potential scales as
\begin{equation}
    \varphi \propto t^b f\!\left(\frac{h}{t^\Delta}\right)
\end{equation}
the metric near criticality ($t,h \to 0$) scales as
\begin{align}
    \left(g_{\mu\nu}\right) \Big|_{\frac{h}{t^\Delta} \to \text{const.}} &\propto 
    \begin{pmatrix}
        t^{b-2} & t^{b-\Delta-1} \\
        t^{b-\Delta-1} & t^{b-2\Delta}
    \end{pmatrix}, \\[4pt]
    \left(g_{\mu\nu}\right) \Big|_{\frac{h}{t^\Delta} \to \infty} &\propto
    \begin{pmatrix}
        t^{-2}h^p & t^{-1}h^{p-1} \\
        t^{-1}h^{p-1} & h^{p-2}
    \end{pmatrix}.
\end{align}
Here, the two limits correspond to different asymptotic behaviors of $f$ as $\frac{h}{t^\Delta}$ tends to a constant or diverges.

To study length divergences, we must specify the path in parameter space, which determines the scaling of $\frac{h}{t^\Delta}$.  
We consider two representative cases.

\paragraph{Case 1: $\frac{h}{t^\Delta} \to \text{const.}$ \label{par:scalingCase_1}}
\begin{equation}
    \begin{pmatrix}
        t \\ h
    \end{pmatrix} =
    \begin{pmatrix}
        s \\ s^k
    \end{pmatrix}, \quad k \ge \Delta
\end{equation}
for which
\begin{equation*}
    \frac{h}{t^\Delta} \xrightarrow[s \to 0]{} \text{const.}
\end{equation*}
The metric contributions then scale as
\begin{align*}
    g_{tt} \dot{t}^2 &\propto s^{b-2} \\
    g_{th} \dot{t}\dot{h} &\propto s^{b-2+(k-\Delta)} \\
    g_{hh} \dot{h}^2 &\propto s^{b-2+2(k-\Delta)}
\end{align*}
Since $k \ge \Delta$, the sufficient condition for convergence of the Ruppeiner length $\mathcal{L}$ is
\begin{equation}
    b > 0
\end{equation}
As established earlier, convergence of $\mathcal{L}$ is necessary and sufficient for convergence of the Salamon dissipated availability $\mathcal{A}$ in finite-time protocols, provided $\bar{\epsilon}$ remains finite.

\paragraph{Case 2: $\frac{h}{t^\Delta} \to \infty$ \label{par:scalingCase_2}}
\begin{equation}
    \begin{pmatrix}
        t \\ h
    \end{pmatrix} =
    \begin{pmatrix}
        s^{1/k} \\ s
    \end{pmatrix}, \quad k < \Delta
\end{equation}
implying
\begin{equation*}
    \frac{h}{t^\Delta} \xrightarrow[s \to 0]{} \infty
\end{equation*}
In this case,
\begin{align*}
    g_{tt} \,\dot{t}^2 &\propto s^{p-2} &
    g_{th} \,\dot{t}\,\dot{h} &\propto s^{p-2} &
    g_{hh} \,\dot{h}^2 &\propto s^{p-2}
\end{align*}
Hence, convergence requires
\begin{equation}
    p > 0
\end{equation}
Both conditions ($b > 0$ and $p > 0$) hold for several universality classes, as shown in Table~\ref{tab:scaling-divergences}.

\begin{table}[h]
    \centering
    \begin{tabular}{c||c|c}
        & $b$ & $p$ \\
        \hline \hline
        Mean Field & $2$ & $\tfrac{4}{3}$ \\
        2D Ising & $2$ & $\tfrac{16}{15}$ \\
        3D Ising & $1.8899(3)$ & $1.2088(1)$ \\
        2D 3-state Potts & $\tfrac{5}{3}$ & $\tfrac{15}{14}$ \\
        2D 4-state Potts & $\tfrac{4}{3}$ & $\tfrac{16}{15}$ \\
        % 3D XY Model & $ 2.0153(3) $ & $ 1.20923(6) $
    \end{tabular}
    \caption{Scaling parameters for representative universality classes.}
    \label{tab:scaling-divergences}
\end{table}

\subsubsection{Dynamical Scaling Hypothesis}
In both Ruppeiner and Sivak formalisms, dissipation depends on the system’s response time—appearing as $\bar{\epsilon}$ in the former and directly in the metric for the latter.  
Using the dynamical scaling hypothesis, we can study how the relaxation time $\tau$ diverges.

From $\tau \propto \psi^{-z/d}$ and the static scaling relation, we obtain
\begin{equation}
    \tau \propto t^{-bz/d}\, w\!\left(\frac{h}{t^\Delta}\right)
\end{equation}
where $w(x)$ is continuous and satisfies
\begin{equation}
    w(x) \xrightarrow[x\to\infty]{} x^{-pz/d}
\end{equation}
Hence, the divergence of $\tau$ follows
\begin{equation}
    \tau \propto
    \begin{cases}
        t^{-bz/d}, & \frac{h}{t^\Delta} \to \text{const.} \\[4pt]
        h^{-pz/d}, & \frac{h}{t^\Delta} \to \infty
    \end{cases}
\end{equation}

Including this factor modifies the scaling of the metric elements in \hyperref[par:scalingCase_1]{Case 1}
\begin{align}
    g_{tt}\,\dot{t}^2 &\propto s^{b(1-z/d)-2} \\
    g_{th}\,\dot{t}\,\dot{h} &\propto s^{b(1-z/d)-2+(k-\Delta)} \\
    g_{hh}\,\dot{h}^2 &\propto s^{b(1-z/d)-2+2(k-\Delta)}
\end{align}
Thus, the convergence condition becomes
\begin{equation}
    b\!\left(1 - \frac{z}{d}\right) > 0
\end{equation}
Similarly, in \hyperref[par:scalingCase_2]{Case 2}
\begin{equation}
    g_{ij}\dot{x}^i\dot{x}^j \propto s^{p(1-z/d)-2}
\end{equation}
so convergence requires
\begin{equation}
    p\!\left(1 - \frac{z}{d}\right) > 0
\end{equation}

As summarized in Table~\ref{tab:dynamical-divergences}, the thermodynamic lengths diverge for the 2D Ising and 2D Potts models but remain finite for the 3D Ising model.

\begin{table}[h]
    \centering
    \begin{tabular}{c|c||c|c|c}
        \multicolumn{2}{c||}{} & $d$ & $z$ & $z/d$ \\
        \hline \hline
        \multirow{2}{*}{2D Ising} & Class A & $2$ & $2.165(10)$ & $1.083(5)$ \\
                                  & Class B & $2$ & $2.235(10)$ & $1.117(5)$ \\
        \hline
        \multicolumn{2}{c||}{3D Ising} & $3$ & $2.032(4)$ & $0.677(1)$ \\
        \hline
        \multicolumn{2}{c||}{2D 3-state Potts} & $2$ & $2.198(2)$ & $1.099(1)$ \\
        \hline
        \multicolumn{2}{c||}{2D 4-state Potts} & $2$ & $2.290(3)$ & $1.095(2)$ \\
    \end{tabular}
    \caption{Dynamical scaling parameters for representative universality classes \cite{odor_universality_2004}.}
    \label{tab:dynamical-divergences}
\end{table}


\subsection{Antiferromagnetic Mean-Field Model - Ruppiner metric}
\input{AntiFerro-MeanField-Ruppiner/Intro}
\input{AntiFerro-MeanField-Ruppiner/disorderedPhase}
% \input{AntiFerro-MeanField-Ruppiner/AntiFerroPhase}
 
\subsection{Antiferromagnetic Mean-Field Model - Sivak metric}
\omer{I wrote this assuming we will only publish this, and not the Ruppiner metric}

\input{AntiFerro-MeanField-Sivak/intro}
\input{AntiFerro-MeanField-Sivak/disorderedPhase}
\input{AntiFerro-MeanField-Sivak/AntiFerroPhase}
\input{AntiFerro-MeanField-Sivak/minimalPaths}

\input{2D_Ising_Calculation}


\bibliography{ThermodynamicGeometry}
\end{document}