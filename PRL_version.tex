\documentclass[%
 reprint,
%superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,
%pra,
%prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}

% For Thesis
% \documentclass[pra,preprint, ,superscriptaddress,notitlepage,longbibliography]{revtex4-2}
% \usepackage{anyfontsize}
% \renewcommand{\normalsize}{\fontsize{12}{14}\selectfont}
% \linespread{1.5}
% \usepackage[margin=1.5cm]{geometry}
% \usepackage{newtxtext,newtxmath}

\usepackage[normalem]{ulem}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{cancel}
\usepackage{nicefrac}
\usepackage{multirow}
\usepackage[dvipsnames]{xcolor} % for colors 
\usepackage{xspace}
\usepackage[hidelinks]{hyperref}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{comment}

%\newcommand{\oren}[1]{{\color{red} [Oren:]\xspace}}%\usepackage{hyperref}% add hypertext capabilities
\newcommand{\oren}[1]{{\color{red} [Oren: #1]\xspace}}
\newcommand{\omer}[1]{{\color{ForestGreen} [Omer: #1]\xspace}}
\newcommand{\arctanh}[0]{\text{arctanh}}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\done}[0]{{\color{ForestGreen} \checkmark \quad}}

%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}


\begin{document}

\preprint{APS/123-QED}

\title{Thermodynamic Geometry Through Second Order Phase Transitions}

\author{Omer M. Basri}
 \email{omer.basri@weizmann.ac.il}
\author{Oren Raz}
 \email{oren.raz@weizmann.ac.il}
\affiliation{%
 Department of Physics of Complex Systems,\\Weizmann Institute of Science, Rehovot 76100, Israel. 
}%

\date{\today}

\begin{abstract}
A useful approach to quantify excess dissipation in slowly driven thermodynamic processes is through the use of a Riemannian metric on the space of control parameters, where optimal driving protocols follow geodesics.
Near phase transitions, this geometric picture breaks down as the metric diverges and geodesics may cease to exist.
Using the scaling and dynamical scaling hypotheses, we analyze this framework across several universality classes and show that the thermodynamic length can remain finite.
We then demonstrate a numerical approach for computing minimal paths in such systems. We show that, in some regimes, the shortest path crosses the phase transition -- even when alternative paths confined to a single phase exist.
\end{abstract}

\maketitle


\paragraph{Introduction}
\input{Intro_PRL}


\paragraph{Framework} \label{sec:framework}
Here we briefly define the key metrics and scaling tools used in our study. The dissipation metric, first introduced in \cite{sivakThermodynamicMetricsOptimal2012}, is defined as
\begin{equation}\label{Eq:Metric}
    g_{\mu\nu} = \beta \int_0^\infty \langle \delta X_\mu(t)\, \delta X_\nu(0) \rangle\, dt =
    \beta \mathcal{T}_{\mu\nu} \frac{\partial^2 \ln Z}{\partial \lambda^\mu \partial \lambda^\nu}
\end{equation}
where $\mathcal{T}_{\mu\nu}$ is the time integrated temporal response matrix, $Z$ the partition function, and $X_\mu$ the conjugate variable to $\lambda^\mu$ -- the natural variables of the free energy, e.g., $\{X_1,X_2\} = \{S, M\}$ for $F(T, h)$ \footnote{We assume that the Hamiltonian of the system is linear with $\lambda_i$.}.
The dissipated availability, which expresses the excess dissipation in performing the trajectory $\boldsymbol{\lambda(t)}$ in parameter space, is given by
\begin{equation} \label{Eq:DissipationRelation}
    \mathcal{A} = \int_{\boldsymbol{\lambda}(t)} g_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu\, dt.
\end{equation}
It is related to the length associated with the thermodynamic metric, defined by
\begin{equation}
    \mathcal{L} = \int_{\boldsymbol{\lambda}(s)} \sqrt{g_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu}\, ds
\end{equation}
through the inequality
\begin{equation}\label{Eq:A_bound}
    \mathcal{A} \ge \frac{\mathcal{L}^2}{T}
\end{equation}
 (here $T$ is the protocol duration, and $\lambda(s)$ parametrize the trajectory in parameter space). This bound is saturated for protocols with $g_{\mu\nu}\, \dot{\lambda}^\mu \dot{\lambda}^\nu=const.$ at all time \cite{salamonThermodynamicLengthDissipated1983}.

%\subsection{Scaling Hypothesis} \label{subsec:ScalingHypothesisFramework}
Near second order phase transitions, second derivatives of the free energy ---and hence the metric defined in Eq.(\ref{Eq:Metric})--- diverge. The asymptotic form of these divergences is determined by critical exponents, that are common to all models that belong to the same universality class. These critical exponents can be analyzed using Widom's scaling \cite{stanley1987introduction}, which for Ising type models relates the free energy $\varphi$ near the critical point $(T_c, H_c)$ to reduced variables, often chosen to be $t = (T - T_c)/T_c$ and $h = (H - H_c)/H_c$. The Widom scaling then states that
\begin{equation} \label{eq:ScalingHyp}
    \varphi \propto t^b f\!\left(\frac{h}{t^\Delta}\right)
\end{equation}
where $f(x)$ is continuous and $f(x) \sim x^p$ as $x \to \infty$ \cite{Kardar_2007}.
The exponents $b$, $\Delta$, $p$, are enough to uniquely dictate the standard critical exponents through the hyperscaling relations, e.g., the heat capacity exponent $\alpha$ defined through $C_H(t)\sim |t|^{-\alpha}$ is given by $\alpha = 2 - b$.
This approach captures divergences of the free energy second derivatives across phase transitions, but does not address relaxation times, which are critical for the dissipation metric in Eq.(\ref{Eq:Metric}). This can nevertheless be done using the dynamical scaling relations \cite{hohenberg1977theory}, that relates the relaxation time $\tau$ and correlation length $\xi$ as
\begin{equation}
    \tau \propto \xi^z
\end{equation}
and the free energy scales as $\varphi \propto \xi^{-d}$ \cite{Kardar_2007, tauberCriticalDynamicsField2014}.
Combining these yields
\begin{equation}\label{eq:TimeResponsScaling}
    \tau \propto \varphi^{-z/d} \propto t^{-bz/d}\, f^{-z/d}\!\left(\frac{h}{t^\Delta}\right)
\end{equation}
linking dynamical and thermodynamic critical behavior.

%\subsection{Divergence of Lengths}
With the Widom and dynamical scaling, it is thus possible to find the divergence of the metric near the phase transition at various equivalence classes. Diverging metric, however, does not necessarily imply a divergent thermodynamic length.
Since it is always possible to saturate the equality in  Eq.(\ref{Eq:A_bound}),  finite thermodynamic length guarantees the existence of a finite-dissipation protocol. In addition,  $\mathcal{L} \to \infty$ implies $\mathcal{A} \to \infty$ for all finite time protocols.
Consequently, the convergence of thermodynamic length determines whether finite-dissipation protocols exist. 
If $\dot{\mathcal{L}}(s) = \sqrt{g_{\mu\nu}\dot{\lambda}^\mu\!\left(s\right)\dot{\lambda}^\nu\!\left(s\right)} \propto s^{-a}$ near criticality (as $s \rightarrow 0$), the total length diverges only for $a > 1$. Note, however, that finite distance across a phase transition does not necessarily inform  us about the metric itself, or the intrinsic geometry of the manifold. The metric might diverge for flat space \cite{PhysRev.119.1743,Szekeres:1960gm}, and the manifold might have divergent curvature despite having finite lengths and a non-divergent metric. 


\paragraph{Results}

%\subsection{Scaling Hypothesis} \label{subsec:ScalingHypothesisResults}

%\subsubsection{Scaling Hypothesis for the Free Energy}
The metric near a phase transition diverges when either one of the free energy derivatives or the time responses diverge. Since the singular part of the thermodynamic potential scales as Eq.(\ref{eq:ScalingHyp}), the scaling of the derivatives depends on the direction of the approach to criticality. Specifically, the two possible asymptotic behaviors are 
\begin{align}
    \left(\frac{\partial^2 \ln Z}{\partial \lambda^\mu \partial \lambda^\nu}\right) \Big|_{\frac{h}{t^\Delta} \to \text{const.}} &\propto 
    \begin{pmatrix}
        t^{b-2} & t^{b-\Delta-1} \\
        t^{b-\Delta-1} & t^{b-2\Delta}
    \end{pmatrix}, \\[4pt]
    \left(\frac{\partial^2 \ln Z}{\partial \lambda^\mu \partial \lambda^\nu}\right) \Big|_{\frac{h}{t^\Delta} \to \infty} &\propto
    \begin{pmatrix}
        t^{-2}h^p & t^{-1}h^{p-1} \\
        t^{-1}h^{p-1} & h^{p-2}
    \end{pmatrix}.
\end{align}
The time response divergence in the two cases can be obtained from  Eq.(\ref{eq:TimeResponsScaling}). From the static scaling relation, we obtain that the divergence of $\tau$ follows
\begin{equation} \label{Eq:tauPropto}
    \tau \propto
    \begin{cases}
        t^{-bz/d}, & \frac{h}{t^\Delta} \to \text{const.} \\[4pt]
        h^{-pz/d}, & \frac{h}{t^\Delta} \to \infty
    \end{cases}
\end{equation}
Together, the derivatives of the free energy and the response time imply the following scaling: For $\frac{h}{t^\Delta} \to \text{const.}$, one finds that
\begin{align}
    g_{tt}\,\dot{t}^2 &\propto s^{b(1-z/d)-2} \\
    g_{th}\,\dot{t}\,\dot{h} &\propto s^{b(1-z/d)-2+(k-\Delta)} \\
    g_{hh}\,\dot{h}^2 &\propto s^{b(1-z/d)-2+2(k-\Delta)}
\end{align}
In the above equations, the approach of the protocol to the critical point is asymptotically parametrized by $(t,h)\sim(s,s^k)$. This parametrization assures $h/t^\Delta\to const.$ in the limit $s\to 0$. Regardless of the exact value of $k>\Delta$, the convergence condition becomes
\begin{equation}
    b\!\left(1 - \frac{z}{d}\right) > 0
\end{equation}
Similarly, for $\frac{h}{t^\Delta} \to \infty$,
\begin{equation}
    g_{ij}\dot{\lambda}^i\dot{\lambda}^j \propto s^{p(1-z/d)-2}
\end{equation}
so convergence requires
\begin{equation}
    p\!\left(1 - \frac{z}{d}\right) > 0
\end{equation}
These relations can be used to explore the distance divergence across phase transitions in various models. As summarized in Table~\ref{tab:dynamical-divergences}, the thermodynamic lengths diverge for the 2D Ising and 2D Potts models. Surprisingly, however, it remains finite for the 3D Ising model.

\begin{comment}
    \begin{table}[h]
    \centering
    \begin{tabular}{c|c||c|c|c}
        \multicolumn{2}{c||}{} & $d$ & $z$ & $z/d$ \\
        \hline \hline
        \multirow{2}{*}{2D Ising} & Class A & $2$ & $2.165(10)$ & $1.083(5)$ \\
                                  & Class B & $2$ & $2.235(10)$ & $1.117(5)$ \\
        \hline
        \multicolumn{2}{c||}{3D Ising} & $3$ & $2.032(4)$ & $0.677(1)$ \\
        \hline
        \multicolumn{2}{c||}{2D 3-state Potts} & $2$ & $2.198(2)$ & $1.099(1)$ \\
        \hline
        \multicolumn{2}{c||}{2D 4-state Potts} & $2$ & $2.290(3)$ & $1.095(2)$ \\
    \end{tabular}
    \caption{Dynamical scaling parameters for representative universality classes \cite{odor_universality_2004}.}
    \label{tab:dynamical-divergences}
\end{table}
\end{comment}
\begin{table}[h]
    \centering
    \renewcommand{\arraystretch}{1.5} % Increase vertical padding
    \begin{tabular}{c|c||c|c|c}
        \multicolumn{2}{c||}{} & $b$ & $p$ &  $z/d$ \\
        \hline \hline
        \multirow{2}{*}{2D Ising} & Class A & \multirow{2}{*}{2} & \multirow{2}{*}{$\frac{16}{15}$} & $1.083(5)$ \\
                                  & Class B & & & $1.117(5)$ \\
        \hline
        \multicolumn{2}{c||}{3D Ising} & $1.8899(3)$ & $ 1.2088(1) $ & $0.677(1)$ \\
        \hline
        \multicolumn{2}{c||}{2D 3-state Potts} & $\frac{5}{3}$ & $\frac{15}{14}$ & $1.099(1)$ \\
        \hline
        \multicolumn{2}{c||}{2D 4-state Potts} & $\frac{4}{3}$ & $\frac{16}{15}$ & $1.095(2)$ \\
    \end{tabular}
    \caption{Scaling parameters for representative universality classes \cite{odor_universality_2004}.}
    \label{tab:dynamical-divergences}
\end{table}

\paragraph{Linear Response Applicability:}
As shown in previous works, the validity of the dissipation relation given in Eq.\eqref{Eq:DissipationRelation} requires a separation of timescales between the systemâ€™s relaxation rate and the rate of change of the control parameters \cite{rotskoffGeometricApproachOptimal2017}.
This condition can be satisfied in certain models.
Assume that the relaxation time diverges near the phase transition as $\tau\propto (\lambda^\mu)^{-\kappa}$ for some reduced control parameter $\lambda^\mu$ that goes to 0 at the phase transition, and $\kappa>0$. If the protocol is driven with $\dot{\lambda}^\mu \propto (\lambda^\mu) ^ a$ with $a>\kappa$, so that the protocol slows down faster than the response time diverges, then the trajectory is in the linear-response regime  throughout the evolution. Such protocols correspond to algebraic slowdowns near the critical point and are physically realizable \cite{holtzman2025shortcuts}.
To ensure that this is a finite time protocol, we require that the total driving time
\begin{equation}
    T = \intop_0 \frac{d\lambda^\mu}{\dot{\lambda}^\mu} < \infty
\end{equation}
remains finite, which holds for $a<1$. Therefore, finite-time protocols that remain entirely within the linear-response regime exist if and only if $\kappa < 1$. Note that the condition $\kappa<1$ is independent of the geometric convergence conditions derived earlier.

From Eq.~\eqref{Eq:tauPropto}, the two relevant cases are:
\begin{align}
    \frac{h}{t^\Delta} & \to \text{const.} \, : & \lambda^\mu & =t & \kappa & = \frac{bz}{d} \\
     \frac{h}{t^\Delta} & \to \infty \, : & \lambda^\mu & = h & \kappa &= \frac{pz}{d}
\end{align}
Although the examples discussed above do not necessarily satisfy $\kappa < 1$, models with this property do exist.
One notable case is the quantum 2D transverse-field Ising model, which belongs to the same universality class as the 3D classical Ising model \cite{ZHANG2021114632,10.1143/PTP.56.1454}, and hence has finite length across the phase transition \footnote{See \cite{scandi2019thermodynamic} for discussion on thermodynamic geometry in quantum systems}.
Using the corresponding critical exponents from the 3D Ising model and the dynamic critical exponent $z = 1$ \cite{Continentino_2017, Sachdev_2011}, we find:
\begin{align}
    \frac{h}{t^\Delta} & \to \text{const.} \, : & \kappa & = \frac{bz}{d+1} = 0.630 < 1 \\
     \frac{h}{t^\Delta} & \to \infty \, : & \kappa &= \frac{pz}{d+1} = 0.402 < 1
\end{align}
Thus, the quantum 2D transverse-field Ising model provides an example of a system where the phase transition can be crossed at a finite time, with a finite dissipated availability.

\begin{comment}

It is, indeed true that the response time of the system diverges. However, since the metric diverges, the rate of change of the control parameters should become infinitely slow. 
However, as long as the divergence of the response time is slow enough, we can promise that there exist finite time protocols that will diverge slower, such that the protocol will always stay within the linear response regime. 
This can be quantified as follows: For a response time that is divergent as $\tau\propto s^{-\iota}$, a protocol that started in the linear response regime, where 
\begin{equation}
    \sqrt{\sum_\mu \left({\dot{\lambda}}^{\prime \mu}\right)^2}  \propto s^{a}
\end{equation}
will always remain within the linear response regime if $a>\iota$.

Old (Probably wrong) explanation, keeping in case I will need some of this in the future.

If the covariances diverge as $\partial_\mu\partial_\nu Z \propto s^\upsilon$, the protocol time will be
\begin{equation}
    T\propto\int \frac{d\mathcal{L}}{\sqrt{\dot{\lambda}^{\prime\mu} g_{\mu\nu} \dot{\lambda}^{\prime\nu}}} = \int ds \sqrt{\frac{\dot{\lambda}^{\mu} g_{\mu\nu} \dot{\lambda}^{\nu}}{\dot{\lambda}^{\prime\mu} g_{\mu\nu} \dot{\lambda}^{\prime\nu}}} = \int ds \sqrt{\frac{s^{(\iota + \upsilon)/2}}{s^a}}
\end{equation}
(where the not-primed $\lambda$ is assumed to be a "constant speed" protocol)

The protocol duration will be finite if $a < 1+\frac{\iota+\upsilon}{2}$. Meaning there exists a finite time protocol that always stays within the linear response regime if
\begin{equation} \label{eq:ExistenceOfLinearResponsePreservingPath}
    \iota<2+\upsilon
\end{equation}
Translating to the critical exponents in the scaling hypothesis:
\begin{equation}
    \iota=\begin{cases}
        b\frac{z}{d}  & \frac{h}{t^\Delta} \to \text{const.} \\[4pt]
        p\frac{z}{d} & \frac{h}{t^\Delta} \to \infty
    \end{cases}
\end{equation}
\begin{equation}
    \upsilon=\begin{cases}
        2 - b  & \frac{h}{t^\Delta} \to \text{const.} \\[4pt]
        2 - p & \frac{h}{t^\Delta} \to \infty
    \end{cases}
\end{equation}
And it is apparent that inequality \eqref{eq:ExistenceOfLinearResponsePreservingPath} holds for the 3D Ising model.
----------------
If $\iota<1$, there will exist protocols with $\iota<a<1$, such that
\begin{equation}
    T\propto\intop \frac{ds}{s^a} <\infty
\end{equation}
While 
\begin{equation}
    \iota=\begin{cases}
        b\frac{z}{d}  & \frac{h}{t^\Delta} \to \text{const.} \\[4pt]
        p\frac{z}{d} & \frac{h}{t^\Delta} \to \infty
    \end{cases}
\end{equation}
is generally larger than 1, there do exist models, such as the quantum 2D Transverse Field Ising model \cite{Sachdev_2011,PhysRevB.59.11471}, where $\iota<1$.


------------------------------------
Viewing the metric as before as a multiplication of the response time and equilibrium covariances \ref{Eq:Metric}, if the rate of divergence of the metric follows the relation $\left(g_{ij}\right)\propto s^{-\iota-\upsilon}$ with $\tau\propto s^\iota$ and $\partial_{i,j}\ln Z\propto s^\upsilon$, we expect the rate of change in a constant speed protocol to be 
\begin{equation}
    \sqrt{\sum_i \left(\lambda^i\right)^2}  \propto s^{\nicefrac{(\iota + \upsilon)}{2}}
\end{equation}
And linear response will always be applicable for a protocol that starts within the linear response regime, if $\iota>\upsilon$. While for the classical models

\end{comment}

\paragraph{An example:}

\input{AntiFerro-MeanField-Sivak/intro_PRL}
\input{AntiFerro-MeanField-Sivak/disorderdPhase_PRL}
\input{AntiFerro-MeanField-Sivak/AntiFerroPhase_PRL}
\input{AntiFerro-MeanField-Sivak/minimalPaths_PRL}

\paragraph{Conclusions} To conclude, we showed that although the dissipation metric diverges at a second order phase transition, for some universality classes crossing the phase transition can be achieved at a finite thermodynamic length. Surprisingly, we find that the optimal trajectory between two points that are in the same phase might even cross to the other phase and back to the initial phase. Many related problems, however, remain open: How can first order phase transitions be incorporate to such a framework? Are there models where the critical exponents vary continuously along the phase transition line (e.g. the 2D Ashkin-Teller model \cite{aoun2024phase}) such that crossing the phase transition cost infinite dissipation for some parts of the phase transition line, but finite for others? Lastly, many heat engines and refrigerators work intentionally near the phase transition \cite{campisi2016power}. Using the suggested framework to optimize their protocol can be an interesting application.   

%\input{2D_Ising_Calculation}
\paragraph{Acknowledgments} O.R. acknowledges financial support from ISF Grant No. 232/23 and from the Minerva foundation with funding from the Federal German Ministry for Education and Research. We thank David Sivak for many useful discussions and for his hospitality.

\bibliography{ThermodynamicGeometry}
\newpage
\input{EndMatter}
\end{document}